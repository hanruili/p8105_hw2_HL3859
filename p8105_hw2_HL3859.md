p8105_hw2_HL3859
================
Hanrui Li
2024-09-25

# Problem 1

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
nyc = 
  read_csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") |>
  janitor::clean_names()
```

    ## Rows: 1868 Columns: 32
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (22): Division, Line, Station Name, Route1, Route2, Route3, Route4, Rout...
    ## dbl  (8): Station Latitude, Station Longitude, Route8, Route9, Route10, Rout...
    ## lgl  (2): ADA, Free Crossover
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
nyc_clean = 
  nyc |>
  select(line, station_name, station_latitude, station_longitude, route1:route11, 
         entry, vending, entrance_type, ada) |>
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))

nyc_clean
```

    ## # A tibble: 1,868 × 19
    ##    line     station_name station_latitude station_longitude route1 route2 route3
    ##    <chr>    <chr>                   <dbl>             <dbl> <chr>  <chr>  <chr> 
    ##  1 4 Avenue 25th St                  40.7             -74.0 R      <NA>   <NA>  
    ##  2 4 Avenue 25th St                  40.7             -74.0 R      <NA>   <NA>  
    ##  3 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ##  4 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ##  5 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ##  6 4 Avenue 45th St                  40.6             -74.0 R      <NA>   <NA>  
    ##  7 4 Avenue 45th St                  40.6             -74.0 R      <NA>   <NA>  
    ##  8 4 Avenue 45th St                  40.6             -74.0 R      <NA>   <NA>  
    ##  9 4 Avenue 45th St                  40.6             -74.0 R      <NA>   <NA>  
    ## 10 4 Avenue 53rd St                  40.6             -74.0 R      <NA>   <NA>  
    ## # ℹ 1,858 more rows
    ## # ℹ 12 more variables: route4 <chr>, route5 <chr>, route6 <chr>, route7 <chr>,
    ## #   route8 <dbl>, route9 <dbl>, route10 <dbl>, route11 <dbl>, entry <lgl>,
    ## #   vending <chr>, entrance_type <chr>, ada <lgl>

The dataset contains `line` which shows 36 subway lines. `station_name`
represents the names of the station. `station_latitude` and
`station_longitude` represent the coordinates of the station. `route1`
to `route11` show the subway routes served by the station, there are 11
routes. `entry` indicates whether entrance is allowed (TRUE/FALSE).
`vending` indicates whether there is a vending machine (YES/NO).
`entrance_type` is the type of entrance (e.g. Stair, Elevator, Easement,
Escalator, Door, Ramp, Walkway). `ada` inndicates whether the station is
compliant with ADA standards (TRUE/FALSE). I selected relevant columns
from the dataset and converted the `entry` variable to a logical
variable for easier analysis. After cleaning, the dataset has 1868 rows
and 19 columns. This dataset is tidy as each column represents a
variable and each row represents a single observation (an
entrance/exit).

``` r
nyc_clean |>
  distinct(line, station_name) |>
  nrow()
```

    ## [1] 465

- There are 465 distinct stations.

``` r
nyc_clean |>
  filter(ada == "TRUE") |>
  distinct(line, station_name) |>
  nrow()
```

    ## [1] 84

- 84 stations are ADA compliant.

``` r
nyc_clean |>
  filter(vending == "NO") |>
  summarise(proportion = mean(entry))
```

    ## # A tibble: 1 × 1
    ##   proportion
    ##        <dbl>
    ## 1      0.377

- 37.70% of station entrances / exits without vending allow entrance.

``` r
nyc_routes = 
  nyc_clean |>
  mutate(across(starts_with("route"), as.character)) |>
  pivot_longer(
    route1:route11,
    names_to = "route_name", 
    values_to = "route_number") |>
  filter(!is.na(route_number))

nyc_routes
```

    ## # A tibble: 4,270 × 10
    ##    line     station_name station_latitude station_longitude entry vending
    ##    <chr>    <chr>                   <dbl>             <dbl> <lgl> <chr>  
    ##  1 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ##  2 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ##  3 4 Avenue 36th St                  40.7             -74.0 TRUE  YES    
    ##  4 4 Avenue 36th St                  40.7             -74.0 TRUE  YES    
    ##  5 4 Avenue 36th St                  40.7             -74.0 TRUE  YES    
    ##  6 4 Avenue 36th St                  40.7             -74.0 TRUE  YES    
    ##  7 4 Avenue 36th St                  40.7             -74.0 TRUE  YES    
    ##  8 4 Avenue 36th St                  40.7             -74.0 TRUE  YES    
    ##  9 4 Avenue 45th St                  40.6             -74.0 TRUE  YES    
    ## 10 4 Avenue 45th St                  40.6             -74.0 TRUE  YES    
    ## # ℹ 4,260 more rows
    ## # ℹ 4 more variables: entrance_type <chr>, ada <lgl>, route_name <chr>,
    ## #   route_number <chr>

``` r
nyc_routes |>
  filter(route_number == "A") |>
  distinct(line, station_name) |>
  nrow()
```

    ## [1] 60

``` r
nyc_routes |>
  filter(route_number == "A", ada == "TRUE") |>
  distinct(line, station_name) |>
  nrow()
```

    ## [1] 17

- There are 60 distinct stations serve the A train.

- Of the stations that serve the A train, 17 are ADA compliant.

# Problem 2

``` r
library(readxl)
library(dplyr)

trash_wheel = 
  read_excel("data/202309 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", skip = 1) |>
  select(dumpster = `Dumpster`, month = `Month`, year = `Year`, date = `Date`,
      weight_tons = `Weight (tons)`, volume_cubic_yards = `Volume (cubic yards)`,
      plastic_bottles = `Plastic Bottles`, polystyrene = `Polystyrene`,
      cigarette_butts = `Cigarette Butts`, glass_bottles = `Glass Bottles`,
      plastic_bags = `Plastic Bags`, wrappers = `Wrappers`,
      sports_balls = `Sports Balls`, homes_powered = `Homes Powered*`) |>
  filter(!is.na(dumpster)) |>
  mutate(sports_balls = as.integer(round(sports_balls)), 
         homes_powered = (weight_tons * 500 / 30),
         trash_wheel = "Mr. Trash Wheel")
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

``` r
trash_wheel
```

    ## # A tibble: 584 × 15
    ##    dumpster month year  date                weight_tons volume_cubic_yards
    ##       <dbl> <chr> <chr> <dttm>                    <dbl>              <dbl>
    ##  1        1 May   2014  2014-05-16 00:00:00        4.31                 18
    ##  2        2 May   2014  2014-05-16 00:00:00        2.74                 13
    ##  3        3 May   2014  2014-05-16 00:00:00        3.45                 15
    ##  4        4 May   2014  2014-05-17 00:00:00        3.1                  15
    ##  5        5 May   2014  2014-05-17 00:00:00        4.06                 18
    ##  6        6 May   2014  2014-05-20 00:00:00        2.71                 13
    ##  7        7 May   2014  2014-05-21 00:00:00        1.91                  8
    ##  8        8 May   2014  2014-05-28 00:00:00        3.7                  16
    ##  9        9 June  2014  2014-06-05 00:00:00        2.52                 14
    ## 10       10 June  2014  2014-06-11 00:00:00        3.76                 18
    ## # ℹ 574 more rows
    ## # ℹ 9 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>, trash_wheel <chr>

``` r
prof_trash_wheel = 
  read_excel("data/202309 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", skip = 1) |>
  select(dumpster = `Dumpster`, month = `Month`, year = `Year`, date = `Date`,
      weight_tons = `Weight (tons)`, volume_cubic_yards = `Volume (cubic yards)`,
      plastic_bottles = `Plastic Bottles`, polystyrene = `Polystyrene`,
      cigarette_butts = `Cigarette Butts`, glass_bottles = `Glass Bottles`,
      plastic_bags = `Plastic Bags`, wrappers = `Wrappers`,
      homes_powered = `Homes Powered*`) |>
  filter(!is.na(dumpster)) |>
  mutate(year = as.character(year))
  
prof_trash_wheel
```

    ## # A tibble: 106 × 13
    ##    dumpster month    year  date                weight_tons volume_cubic_yards
    ##       <dbl> <chr>    <chr> <dttm>                    <dbl>              <dbl>
    ##  1        1 January  2017  2017-01-02 00:00:00        1.79                 15
    ##  2        2 January  2017  2017-01-30 00:00:00        1.58                 15
    ##  3        3 February 2017  2017-02-26 00:00:00        2.32                 18
    ##  4        4 February 2017  2017-02-26 00:00:00        3.72                 15
    ##  5        5 February 2017  2017-02-28 00:00:00        1.45                 15
    ##  6        6 March    2017  2017-03-30 00:00:00        1.71                 15
    ##  7        7 April    2017  2017-04-01 00:00:00        1.82                 15
    ##  8        8 April    2017  2017-04-20 00:00:00        2.37                 15
    ##  9        9 May      2017  2017-05-10 00:00:00        2.64                 15
    ## 10       10 May      2017  2017-05-26 00:00:00        2.78                 15
    ## # ℹ 96 more rows
    ## # ℹ 7 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, homes_powered <dbl>

``` r
gwynnda_trash_wheel = 
  read_excel("data/202309 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel", skip = 1) |>
  select(dumpster = `Dumpster`, month = `Month`, year = `Year`, date = `Date`,
      weight_tons = `Weight (tons)`, volume_cubic_yards = `Volume (cubic yards)`,
      plastic_bottles = `Plastic Bottles`, polystyrene = `Polystyrene`,
      cigarette_butts = `Cigarette Butts`, plastic_bags = `Plastic Bags`, 
      wrappers = `Wrappers`, homes_powered = `Homes Powered*`) |>
  filter(!is.na(dumpster)) |>
  mutate(year = as.character(year))

gwynnda_trash_wheel
```

    ## # A tibble: 155 × 12
    ##    dumpster month  year  date                weight_tons volume_cubic_yards
    ##       <dbl> <chr>  <chr> <dttm>                    <dbl>              <dbl>
    ##  1        1 July   2021  2021-07-03 00:00:00        0.93                 15
    ##  2        2 July   2021  2021-07-07 00:00:00        2.26                 15
    ##  3        3 July   2021  2021-07-07 00:00:00        1.62                 15
    ##  4        4 July   2021  2021-07-16 00:00:00        1.76                 15
    ##  5        5 July   2021  2021-07-30 00:00:00        1.53                 15
    ##  6        6 August 2021  2021-08-11 00:00:00        2.06                 15
    ##  7        7 August 2021  2021-08-14 00:00:00        1.9                  15
    ##  8        8 August 2021  2021-08-16 00:00:00        2.16                 15
    ##  9        9 August 2021  2021-08-16 00:00:00        2.6                  15
    ## 10       10 August 2021  2021-08-17 00:00:00        3.21                 15
    ## # ℹ 145 more rows
    ## # ℹ 6 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, plastic_bags <dbl>, wrappers <dbl>,
    ## #   homes_powered <dbl>

``` r
combine = 
  bind_rows(trash_wheel, prof_trash_wheel, gwynnda_trash_wheel)

combine
```

    ## # A tibble: 845 × 15
    ##    dumpster month year  date                weight_tons volume_cubic_yards
    ##       <dbl> <chr> <chr> <dttm>                    <dbl>              <dbl>
    ##  1        1 May   2014  2014-05-16 00:00:00        4.31                 18
    ##  2        2 May   2014  2014-05-16 00:00:00        2.74                 13
    ##  3        3 May   2014  2014-05-16 00:00:00        3.45                 15
    ##  4        4 May   2014  2014-05-17 00:00:00        3.1                  15
    ##  5        5 May   2014  2014-05-17 00:00:00        4.06                 18
    ##  6        6 May   2014  2014-05-20 00:00:00        2.71                 13
    ##  7        7 May   2014  2014-05-21 00:00:00        1.91                  8
    ##  8        8 May   2014  2014-05-28 00:00:00        3.7                  16
    ##  9        9 June  2014  2014-06-05 00:00:00        2.52                 14
    ## 10       10 June  2014  2014-06-11 00:00:00        3.76                 18
    ## # ℹ 835 more rows
    ## # ℹ 9 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>, trash_wheel <chr>

The combined dataset from the Mr. Trash Wheel, Professor Trash Wheel,
and Gwynnda trash wheels includes a total of 845 observations, each
representing a dumpster filled with trash removed from Baltimore’s Inner
Harbor. Key variables include the date (`date`, e.g. 2014-05-16), the
weight of trash collected (`weight_tons)`, e.g. 4.31 tons), and the
number of sports balls recovered (`sports_balls`, e.g. 7). Additionally,
the dataset tracks the number of cigarette butts collected
(`cigarette_butts`, e.g. 1.26^{5}).

For Professor Trash Wheel, the total weight of trash collected across
all available records is 216.26 tons.

In June 2022, Gwynnda collected a total of 1.812^{4} cigarette butts.

# Problem 3

``` r
library(tidyverse)

bakers <- read_csv("data/gbb_datasets/bakers.csv")
```

    ## Rows: 120 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (3): Baker Name, Baker Occupation, Hometown
    ## dbl (2): Series, Baker Age
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
bakes <- read_csv("data/gbb_datasets/bakes.csv")
```

    ## Rows: 548 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (3): Baker, Signature Bake, Show Stopper
    ## dbl (2): Series, Episode
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
results <- read_csv("data/gbb_datasets/results.csv", skip = 2)
```

    ## Rows: 1136 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (2): baker, result
    ## dbl (3): series, episode, technical
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
viewers <- read_csv("data/gbb_datasets/viewers.csv")
```

    ## Rows: 10 Columns: 11
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (11): Episode, Series 1, Series 2, Series 3, Series 4, Series 5, Series ...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
bakers <- bakers |>
  mutate(Series = as.numeric(Series), `Baker Age` = as.numeric(`Baker Age`))

merged_data <- bakes |>
  left_join(bakers, by = c("Baker" = "Baker Name", "Series" = "Series")) |>
  left_join(results, by = c("Baker" = "baker", "Series" = "series", "Episode" = "episode"))

missing_data <- merged_data |>
  summarise_all(~ sum(is.na(.)))

final_data <- merged_data %>%
  arrange(Series, Episode, Baker)

write_csv(final_data, "data/gbb_datasets/final_data.csv")
```
